<!--
  Esquire frameworks (tm)
 
  Copyright(c) 2001, 2025 mir0n&co www.mir0n.me
  mailto:mir0n.the.programmer@gmail.com

  History:
-->
<mat-toolbar class="mat-elevation-z2 esq-dialog-toolbar"
    cdkDrag
    cdkDragRootElement=".cdk-overlay-pane"
    cdkDragHandle
    cdkDragBoundary=".cdk-overlay-container"
>
  <div>
    <img src="{{node.type.icon}}" class="esq-base-icon"/>
    <img src="{{nodeStatusIcon()}}" class="esq-overlay-icon" />
    {{node.name}} 
 </div>
  <button matIconButton mat-dialog-close class = "esq-icon-button" matTooltip = "Close">
    <mat-icon>close</mat-icon>
  </button>
</mat-toolbar>


<mat-dialog-content >
  <mat-tab-group class="esq-mat-tab-group">
    @if (details$ | async; as details) {
      @if (dictionary$ | async; as dictionary) {
        @for (tab of dictionary; track tab.title; let i = $index;) {      
          <mat-tab [label]="tab.title" bodyClass="{{tabContent(i)}}">
            @for (field of tab.fields; track field.name) {
              @if (field.type == 'image') {
                <div class="esq-tab-image-container">
                  <img class="esq-tab-image" src="{{details.image}}" alt="{{details.image}}" />
                </div>
                <mat-divider></mat-divider>
                @if (i == 0) {
                  <div class="esq-simple-grid2">
                    <b>Name:</b>{{node.name}}
                    <b>Node Type:</b>{{nodeTypeName()}}      
                    <b>Node ID:</b>{{node.id}}      
                    <b>Parent Node:</b>{{node.parent ? node.parent.name : 'n/a'}}      
                  </div>                   
                  <mat-divider></mat-divider>
                }
              } @else if (field.type == 'string') {
                  <div class="esq-simple-grid2">
                    <b>{{field.label}}:</b>{{details[field.name]}}
                  </div>                   
              } @else if (field.type == 'href') {
                <div class="esq-simple-grid2">
                  <b>{{field.label}}:</b>
                  <a href="{{details[field.name][0]}}" target="_blank" rel="noopener noreferrer">
                    {{details[field.name][1]}}
                  </a>
                </div>                   
              } @else if (field.type == 'tablist') {
                <esq-tab-list
                  [esqListElements]="details[field.name]"
                  [esqListNodeType]="nodeType(field.listvalues_kind)"
                  [esqListHeader]="field.label"
                  [esqExplorerCallApi]="callApi"
                >
                </esq-tab-list>
              }
            }
          </mat-tab>
        }
      } @else {
        <p>Loading dictioary...</p>
      }
    } @else {
      <p>Loading data...</p>
    }
  </mat-tab-group>
</mat-dialog-content>

<mat-dialog-actions align="center">
  <button #btnClose mat-raised-button mat-dialog-close >Close</button>
</mat-dialog-actions>
